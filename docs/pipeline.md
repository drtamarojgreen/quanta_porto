# Automated Pipeline

This document outlines the automated pipeline for this project.

## 1. Code Commit

When a developer commits code to the repository, a webhook triggers the CI/CD pipeline.

## 2. Build and Test

The pipeline checks out the code, builds the project, and runs all tests.

## 3. Deployment

If the build and tests are successful, the pipeline deploys the application to the staging environment.

## 4. Production Release

After successful testing in the staging environment, the release is manually promoted to production.

# Shell Script Task Pipeline

This section describes the primary task processing pipeline, which is implemented as a set of interacting shell scripts. This pipeline uses a directory-based queueing system to manage tasks.

## Pipeline Components

1.  **Queue Directories**: A set of directories (`pending`, `in-progress`, `completed`, `failed`) that represent the state of a task.
2.  **`quantaporto_daemon.sh`**: A shell script that runs as a background process, continuously monitoring the `pending` directory for new task files.
3.  **`quantaporto_worker.sh`**: A shell script that is invoked by the daemon to process a single task. It parses the task file (in XML format) and generates an executable action script.
4.  **Action Scripts**: The executable scripts generated by the worker, which contain the actual commands to be run for a task.

## Workflow

1.  **Task Creation**: A user or another process creates a new task by placing an XML file in the `pending` queue directory.
2.  **Daemon Polling**: The `quantaporto_daemon.sh` script detects the new file in the `pending` directory.
3.  **Task Dispatch**: The daemon atomically moves the task file to the `in-progress` directory and invokes the `quantaporto_worker.sh` script, passing the path to the task file.
4.  **Task Processing**: The worker script parses the XML task file, extracts the commands, and generates a new, executable shell script in the `actions_pending` directory.
5.  **Action Execution**: It is assumed that another component (referred to as "QuantaSensa" in the scripts) is responsible for executing the generated action script from the `actions_pending` directory.
6.  **Task Completion/Failure**: If the worker script fails, the daemon moves the task file to the `failed` directory. If it succeeds, the task file remains in the `in-progress` directory for potential cleanup by another utility (referred to as "QuantaLista").

---

# C++ Daemon Design (Alternative Implementation)

**Note:** The following describes a C++ based implementation of a task management pipeline. While the repository contains C++ source files in the `interface/` directory that align with this design, the primary, documented pipeline currently in use is the shell script-based system described above.

The C++ daemon will be a lightweight, cross-platform console application with the following design:

## Core Components

1.  **Configuration Manager**: Responsible for loading configuration settings, such as the path to `tasks.txt` and the polling interval.
2.  **File Monitor**: Monitors `tasks.txt` for changes. This can be implemented using a simple polling mechanism.
3.  **Task Parser**: Parses each line of `tasks.txt` to extract the timestamp and task details.
4.  **Task Executor**: Executes the task command. This component should handle command execution in a separate process to avoid blocking the daemon.
5.  **Logger**: Logs daemon activities, such as task execution, errors, and status changes.

## Behavior

1.  **Initialization**: On startup, the daemon will:
    *   Load configuration settings.
    *   Perform an initial check of `tasks.txt` and execute any overdue tasks.
2.  **Main Loop**: The daemon will enter a loop where it:
    *   Sleeps for the configured polling interval.
    *   Wakes up and reads `tasks.txt`.
    *   For each task, it will:
        *   Parse the timestamp.
        *   If the task is due, execute it.
        *   If the task is executed successfully, remove it from the file.
3.  **Signal Handling**: The daemon should gracefully handle signals like `SIGINT` and `SIGTERM` to ensure a clean shutdown.
